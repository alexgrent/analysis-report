[<img src=https://user-images.githubusercontent.com/6883670/31999264-976dfb86-b98a-11e7-9432-0316345a72ea.png height=75 />](https://reactome.org)

Analysis Report
------
Creates a PDF document with a report of an analysis performed in Reactome. Click here to know more about [Analysis Service](https://reactome.org/dev/analysis).


The resulting PDF will contain the minimum information to reproduce the analysis, as well as  details for the most relevant pathways, sorted by p-value.

## Installation
Analysis exporter is developed as a Java library. To add it to your project, you have to use maven:

```
<dependencies>
	<dependency>
		<groupId>org.reactome.server.tools</groupId>
		<artifactId>analysis-report</artifactId>
		<version>1.1.1</version>
	</dependency>
	<!-- ... -->
</dependencies>
<repositories>
	<repository>
		<id>pst-release</id>
		<name>EBI Nexus Repository</name>
		<url>http://www.ebi.ac.uk/Tools/maven/repos/content/repositories/pst-release</url>
	</repository>
	<!-- ... -->
<repositories>
```

## Usage
> This project needs a connection to the grap database (see [graph-core](https://github.com/reactome/graph-core)).

PDFs are generated by an instance of the __ReportBuilder__ class.
``` java
// Configure Reactome graph database
ReactomeGraphCore.initialise("host", "port", "username", "password", Neo4jConfig.class);

AnalysisReport builder = new AnalysisReport(
	EHLD_PATH,       // EHLD (R-HSA-123.svg) files
	DIAGRAM_PATH,    // layout (12345.json) and graph (12345.grap.json) files.
	ANALYSIS_PATH,   // Analysis (res_20210101_1.bin)
	FIREWORKS_PATH,  // Fireworks (Homo_sapiens.json) files
	SVG_SUMMARY);    // svgsummary.txt

OutputStream os = new FileOutputStream(new File("output.pdf"));
AnalysisStoredResult result = new TokenUtils(ANALYSIS_PATH).getFromToken(token);
builder.create(result, "TOTAL", 48887L, numberOfPathways, "modern", "copper plus", "copper", os);

```
The parameters of the *create* method are:

Name | Description
--- | ---
analysis | the analysis results
resource | resource to filter results (default: TOTAL)
species | dbId of the species to filter results (default: 48887L)
maxPathways | max number of pathways to show (default: 25)
diagramProfile | standard or modern (default: modern)
analysisProfile | standard, copper plus, strosobar (default: standard)
fireworksProfile | copper, copper plus, barium lithium or calcium salts (default: copper)
os | output stream

## Structure of the PDF

1. **Introduction:** short text about Reactome and Analysis service.
2. **Properties of analysis:** properties that characterize the analysis.
    * Analysis type
    * Pathways found
    * Identifiers found
    * Projected to human
    * Include interactors
    * Pathways species
    * unique ID of the analysis
3. **Genome-wide overview:** pathway overview with the analysis overlaid.
4. **Most significant pathways table:** table with the _maxPathways_ most significant pathways filtered by _resource_ and _species_ and sorted by FDR.
    * name
    * found entities
    * entities ratio
    * p-value and FDR
    * found reactions
    * reactions ratio
5. **Most significant pathways details**: each of the most significaint pathways is layout in a new page. For each of them, we show:
    * diagram
    * diseases, compartments, inferences
    * summation
    * edit history
    * elements found
6. **Foud identifiers:** List of input identifiers found with their corresponding mapping. If the analysis is an **expression** analysis, more columns are added to show time series.
7. **Not foud identifiers:** list of input identifiers not found.
